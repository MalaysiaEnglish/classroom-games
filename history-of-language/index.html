<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>History of Language â€” Class Quiz</title>
<style>
@import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@700;900&family=Lora:ital,wght@0,400;0,600;1,400&display=swap');

:root {
  --bg: #0a0f1e;
  --panel: #111827;
  --border: rgba(255,255,255,0.1);
  --gold: #f7b731;
  --gold2: #e6a817;
  --accent: #00c9a7;
  --red: #ef4444;
  --blue: #3b82f6;
  --text: #f1f5f9;
  --dim: rgba(241,245,249,0.5);

  --cat1: #1e3a5f;  /* Middle English â€” navy */
  --cat2: #1a5c2a;  /* Word Evolution â€” forest */
  --cat3: #4a1a6b;  /* Borrowed Words â€” purple */
  --cat4: #7a2a0e;  /* Eponyms & Shakespeare â€” rust */
  --cat5: #0d4a3a;  /* Malay Loanwords â€” teal */
}

* { box-sizing:border-box; margin:0; padding:0; }
body { background:var(--bg); color:var(--text); font-family:'Lora',Georgia,serif; min-height:100vh; }
select, select option { background:#1a2a38; color:white; }

/* â”€â”€ HEADER â”€â”€ */
header {
  background:linear-gradient(135deg,#0f172a,#1e293b);
  border-bottom:3px solid var(--gold);
  padding:10px 20px; display:flex; align-items:center;
  justify-content:space-between; gap:12px; flex-wrap:wrap;
}
header h1 {
  font-family:'Playfair Display',serif;
  font-size:clamp(1rem,2.5vw,1.5rem);
  color:var(--gold); letter-spacing:0.04em;
}
.header-btns { display:flex; gap:8px; }
.hbtn {
  padding:6px 14px; border-radius:6px; border:1px solid var(--border);
  background:rgba(255,255,255,0.07); color:var(--text);
  font-family:'Lora',serif; font-size:0.8rem; cursor:pointer; transition:all 0.2s;
}
.hbtn:hover { background:rgba(255,255,255,0.15); }
.hbtn.gold { background:var(--gold); color:#000; border-color:var(--gold); font-weight:700; }

/* â”€â”€ SETUP â”€â”€ */
#setupScreen {
  max-width:600px; margin:40px auto; padding:0 16px;
  display:flex; flex-direction:column; align-items:center; gap:20px;
}
.setup-title {
  font-family:'Playfair Display',serif; font-size:2rem;
  color:var(--gold); text-align:center; margin-bottom:4px;
}
.setup-sub { color:var(--dim); text-align:center; font-size:0.9rem; margin-bottom:8px; }
.setup-section { width:100%; }
.setup-label { font-size:0.72rem; font-weight:700; text-transform:uppercase;
  letter-spacing:0.12em; color:var(--accent); margin-bottom:8px; }
.team-setup { display:flex; gap:8px; flex-wrap:wrap; justify-content:center; }
.team-row {
  display:flex; align-items:center; gap:8px;
  background:rgba(255,255,255,0.05); border:1px solid var(--border);
  border-radius:8px; padding:8px 12px; flex:1; min-width:220px; max-width:260px;
}
.team-dot { width:12px; height:12px; border-radius:50%; flex-shrink:0; }
.team-row input {
  flex:1; background:none; border:none; color:white;
  font-family:'Lora',serif; font-size:0.9rem; outline:none;
}
.team-toggle {
  width:20px; height:20px; border-radius:4px; border:1px solid var(--border);
  background:rgba(255,255,255,0.05); cursor:pointer; display:flex;
  align-items:center; justify-content:center; font-size:0.75rem;
  color:var(--dim); transition:all 0.2s;
}
.team-toggle.on { background:var(--accent); color:#000; border-color:var(--accent); }
.start-btn {
  padding:14px 52px; font-size:1.1rem; font-weight:700;
  background:var(--gold); color:#000; border:none; border-radius:10px;
  cursor:pointer; font-family:'Lora',serif; letter-spacing:0.06em;
  transition:all 0.2s; box-shadow:0 4px 20px rgba(247,183,49,0.4);
}
.start-btn:hover { background:var(--gold2); transform:scale(1.03); }

/* â”€â”€ SCORE BAR â”€â”€ */
#scoreBar {
  display:flex; gap:6px; padding:8px 12px;
  background:rgba(0,0,0,0.3); border-bottom:1px solid var(--border);
  overflow-x:auto; flex-wrap:wrap;
}
.score-chip {
  display:flex; align-items:center; gap:7px;
  background:rgba(255,255,255,0.06); border:2px solid transparent;
  border-radius:8px; padding:5px 12px; transition:all 0.3s;
  white-space:nowrap;
}
.score-chip.active-team { border-color:var(--gold); background:rgba(247,183,49,0.12); }
.score-chip.stealing   { border-color:var(--accent); background:rgba(0,201,167,0.1); animation:pulse 0.8s ease infinite alternate; }
@keyframes pulse { from{opacity:0.7;} to{opacity:1;} }
.chip-dot  { width:10px; height:10px; border-radius:50%; }
.chip-name { font-weight:700; font-size:0.82rem; }
.chip-score{ font-size:1rem; font-weight:900; color:var(--gold); margin-left:4px; }

/* â”€â”€ BOARD â”€â”€ */
#boardScreen { display:none; }
.board-wrap { padding:10px 8px; }

/* Category headers */
.cat-headers { display:grid; grid-template-columns:repeat(5,1fr); gap:6px; margin-bottom:6px; }
.cat-header {
  border-radius:8px 8px 0 0; padding:10px 6px; text-align:center;
  font-family:'Playfair Display',serif; font-size:clamp(0.65rem,1.5vw,0.9rem);
  font-weight:900; letter-spacing:0.03em; line-height:1.2;
}
.cat-header.c0 { background:var(--cat1); }
.cat-header.c1 { background:var(--cat2); }
.cat-header.c2 { background:var(--cat3); }
.cat-header.c3 { background:var(--cat4); }
.cat-header.c4 { background:var(--cat5); }

/* Grid */
.board-grid { display:grid; grid-template-columns:repeat(5,1fr); gap:6px; }
.q-cell {
  aspect-ratio:1.6; border-radius:6px; display:flex; align-items:center;
  justify-content:center; cursor:pointer; transition:all 0.2s;
  font-family:'Playfair Display',serif; font-size:clamp(1.1rem,3vw,2rem);
  font-weight:900; color:var(--gold); border:2px solid rgba(255,255,255,0.1);
  user-select:none;
}
.q-cell.c0 { background:var(--cat1); }
.q-cell.c1 { background:var(--cat2); }
.q-cell.c2 { background:var(--cat3); }
.q-cell.c3 { background:var(--cat4); }
.q-cell.c4 { background:var(--cat5); }
.q-cell:hover:not(.used):not(.disabled) { filter:brightness(1.4); transform:scale(1.03); border-color:var(--gold); }
.q-cell.used { background:rgba(255,255,255,0.04); color:rgba(255,255,255,0.15); cursor:default; border-color:transparent; }
.q-cell.disabled { cursor:default; }

/* Turn indicator */
.turn-bar {
  text-align:center; padding:8px; font-size:clamp(0.85rem,2vw,1.1rem);
  font-weight:700; color:var(--gold); margin-bottom:6px;
}

/* â”€â”€ QUESTION MODAL â”€â”€ */
.modal-overlay {
  position:fixed; inset:0; background:rgba(0,0,0,0.85); z-index:200;
  display:flex; align-items:center; justify-content:center; padding:16px;
}
.modal-box {
  background:#1e293b; border-radius:16px; padding:28px 32px;
  max-width:680px; width:100%;
  border:2px solid rgba(255,255,255,0.15);
  box-shadow:0 20px 60px rgba(0,0,0,0.6);
  animation:modalIn 0.3s cubic-bezier(0.34,1.56,0.64,1) both;
}
@keyframes modalIn { from{transform:scale(0.8);opacity:0;} to{transform:scale(1);opacity:1;} }
.modal-cat {
  font-size:0.7rem; font-weight:800; text-transform:uppercase;
  letter-spacing:0.15em; margin-bottom:6px;
}
.modal-points {
  font-family:'Playfair Display',serif; font-size:2.5rem;
  font-weight:900; color:var(--gold); margin-bottom:14px; line-height:1;
}
.modal-q {
  font-size:clamp(1rem,2.5vw,1.3rem); line-height:1.65;
  margin-bottom:18px; color:white;
}
.modal-q em { color:var(--gold); font-style:normal; font-weight:700; }
.modal-answer {
  background:rgba(0,201,167,0.1); border:1px solid var(--accent);
  border-radius:8px; padding:12px 16px; margin-bottom:18px;
  font-size:1rem; color:var(--accent); font-weight:600;
  display:none;
}
.modal-answer.visible { display:block; animation:fadeIn 0.4s ease; }
@keyframes fadeIn { from{opacity:0;transform:translateY(4px);} to{opacity:1;transform:translateY(0);} }

/* Modal buttons */
.modal-btns { display:flex; gap:8px; flex-wrap:wrap; }
.mbtn {
  flex:1; min-width:100px; padding:10px 14px; border-radius:8px;
  border:none; font-family:'Lora',serif; font-size:0.9rem;
  font-weight:700; cursor:pointer; transition:all 0.2s;
}
.mbtn-reveal { background:rgba(255,255,255,0.1); color:white; border:1px solid var(--border); }
.mbtn-reveal:hover { background:rgba(255,255,255,0.2); }
.mbtn-correct { background:#22c55e; color:white; }
.mbtn-correct:hover { background:#16a34a; }
.mbtn-wrong   { background:rgba(239,68,68,0.2); color:#ef4444; border:1px solid #ef4444; }
.mbtn-wrong:hover { background:rgba(239,68,68,0.35); }
.mbtn-steal   { background:rgba(0,201,167,0.2); color:var(--accent); border:1px solid var(--accent); }
.mbtn-steal:hover { background:rgba(0,201,167,0.35); }
.mbtn-close   { background:rgba(255,255,255,0.07); color:var(--dim); border:1px solid var(--border); }
.mbtn-close:hover { background:rgba(255,255,255,0.15); }

/* Team selector (for steal) */
.steal-picker {
  background:rgba(0,0,0,0.3); border-radius:10px; padding:14px;
  margin-bottom:14px; display:none;
}
.steal-picker.visible { display:block; animation:fadeIn 0.3s ease; }
.steal-label { font-size:0.72rem; font-weight:800; text-transform:uppercase;
  letter-spacing:0.12em; color:var(--accent); margin-bottom:8px; }
.steal-teams { display:flex; gap:8px; flex-wrap:wrap; }
.steal-team-btn {
  padding:8px 16px; border-radius:6px; border:1px solid var(--border);
  background:rgba(255,255,255,0.06); color:white; cursor:pointer;
  font-family:'Lora',serif; font-weight:700; font-size:0.85rem;
  display:flex; align-items:center; gap:6px; transition:all 0.2s;
}
.steal-team-btn:hover { border-color:var(--accent); background:rgba(0,201,167,0.12); }
.steal-team-btn.selected { background:var(--accent); color:#000; border-color:var(--accent); }

/* Stealing banner */
.stealing-banner {
  background:rgba(0,201,167,0.15); border:1px solid var(--accent);
  border-radius:8px; padding:8px 14px; margin-bottom:14px;
  font-size:0.9rem; color:var(--accent); font-weight:600;
  display:none;
}
.stealing-banner.visible { display:block; }

/* â”€â”€ WIN OVERLAY â”€â”€ */
.win-overlay {
  position:fixed; inset:0; z-index:300; background:rgba(0,0,0,0.88);
  display:flex; align-items:center; justify-content:center;
}
.win-box {
  background:#1e293b; border:2px solid var(--gold);
  border-radius:20px; padding:36px 44px; text-align:center;
  animation:modalIn 0.5s cubic-bezier(0.34,1.56,0.64,1) both;
  max-width:500px; width:90%;
}
.win-trophy { font-size:4rem; margin-bottom:8px; }
.win-title { font-family:'Playfair Display',serif; font-size:2rem;
  color:var(--gold); margin-bottom:6px; }
.win-name  { font-size:1.5rem; font-weight:900; margin-bottom:16px; }
.final-scores { display:flex; flex-direction:column; gap:6px; margin-bottom:20px; }
.final-row {
  display:flex; align-items:center; gap:10px;
  background:rgba(255,255,255,0.05); border-radius:8px; padding:8px 14px;
}
.final-row.winner { background:rgba(247,183,49,0.15); border:1px solid var(--gold); }
</style>
</head>
<body>

<header>
  <h1>ğŸ“œ History of Language Quiz</h1>
  <div class="header-btns">
    <button class="hbtn" onclick="showSetup()">âš™ Setup</button>
    <button class="hbtn" onclick="document.documentElement.requestFullscreen?.()">â›¶ Fullscreen</button>
    <button class="hbtn" onclick="window.location.href='../index.html'">â† Home</button>
  </div>
</header>

<!-- â•â• SETUP â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="setupScreen">
  <div class="setup-title">ğŸ“œ History of Language</div>
  <p class="setup-sub">Jeopardy-style quiz Â· Up to 6 teams Â· Teacher judges answers</p>

  <div class="setup-section">
    <div class="setup-label">Teams (toggle on/off, click name to rename)</div>
    <div class="team-setup" id="teamSetup"></div>
  </div>

  <button class="start-btn" onclick="startGame()">â–¶ START QUIZ</button>
</div>

<!-- â•â• GAME â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div id="boardScreen">
  <div id="scoreBar"></div>

  <div class="board-wrap">
    <div class="turn-bar" id="turnBar">â€” Pick a question â€”</div>
    <div class="cat-headers" id="catHeaders"></div>
    <div class="board-grid" id="boardGrid"></div>
  </div>
</div>

<!-- â•â• QUESTION MODAL â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="modal-overlay" id="qModal" style="display:none;">
  <div class="modal-box">
    <div class="modal-cat"  id="mCat"></div>
    <div class="modal-points" id="mPts"></div>
    <div class="modal-q"   id="mQ"></div>
    <div class="modal-answer" id="mAns"></div>
    <div class="stealing-banner" id="stealBanner"></div>
    <div class="steal-picker" id="stealPicker">
      <div class="steal-label">Which team is stealing?</div>
      <div class="steal-teams" id="stealTeams"></div>
    </div>
    <div class="modal-btns" id="mBtns"></div>
  </div>
</div>

<!-- â•â• WIN OVERLAY â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="win-overlay" id="winOverlay" style="display:none;">
  <div class="win-box">
    <div class="win-trophy">ğŸ†</div>
    <div class="win-title">Game Over!</div>
    <div class="win-name"  id="winName"></div>
    <div class="final-scores" id="finalScores"></div>
    <button class="hbtn gold" onclick="showSetup()">Play Again</button>
  </div>
</div>

<script>
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUESTIONS
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const CATEGORIES = [
  { name: 'ğŸ“œ Middle English',        color: 'c0', bg: 'var(--cat1)' },
  { name: 'ğŸ”„ Word Evolution',        color: 'c1', bg: 'var(--cat2)' },
  { name: 'ğŸŒ Borrowed Words',        color: 'c2', bg: 'var(--cat3)' },
  { name: 'âš¡ Eponyms & Shakespeare', color: 'c3', bg: 'var(--cat4)' },
  { name: 'ğŸ‡²ğŸ‡¾ Malay Loanwords',      color: 'c4', bg: 'var(--cat5)' },
];

const QUESTIONS = [
  // â”€â”€ Category 0: Middle English â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  [
    { pts:100, q:`What does the Middle English word <em>heed</em> mean in Modern English?`, a:`Head` },
    { pts:200, q:`Translate this line into Modern English:<br><em>"Hir hosen weren of fyn scarlet reed"</em>`, a:`Her stockings were of fine scarlet red` },
    { pts:300, q:`What does <em>gat-tothed</em> mean, and what does it tell us about the Wife of Bath's appearance?`, a:`Gap-toothed â€” she had gaps between her teeth` },
    { pts:400, q:`Chaucer says the Wife of Bath sat <em>"upon an amblere esily."</em> What is an amblere, and why might Chaucer mention she sat on it easily?`, a:`A pacing horse (ambler) â€” riding easily suggests she is comfortable, experienced, and perhaps wealthy enough to own one` },
    { pts:500, q:`<em>"Housbondes at chirche dore she hadde fyve, Withouten oother compaignye in youthe."</em> What does this tell us about the Wife of Bath's character?`, a:`She had five husbands at the church door (formally married), not counting other company in her youth â€” suggesting she is experienced, bold, and unconventional for the time` },
  ],
  // â”€â”€ Category 1: Word Evolution â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  [
    { pts:100, q:`Is the word <em>good</em> a word that survived, changed, or disappeared from Middle English?`, a:`Survived â€” it is identical in Middle and Modern English` },
    { pts:200, q:`The Middle English word <em>wif</em> has changed. What is the modern version, and how has its meaning narrowed?`, a:`Wife â€” in Middle English it meant any woman; now it only means a married woman` },
    { pts:300, q:`Give one example of a Middle English word that has completely disappeared from Modern English, from the extract.`, a:`Accept any: somdel, scathe, hosen, streite yteyd, koude, ywympled, targe, carpe, per chaunce, nowthe, soothly` },
    { pts:400, q:`The word <em>deer</em> used to mean any wild animal in Old English. The word <em>meat</em> used to mean any food. What process is this called, and what has happened to both words?`, a:`Narrowing (or semantic narrowing) â€” both words have narrowed in meaning over time` },
    { pts:500, q:`Why do you think some Middle English words survived unchanged while others disappeared completely? Give a reason with an example.`, a:`Accept thoughtful answers â€” e.g. common everyday words (good, fair, face) survive because they're used constantly; specialist words (ywympled, targe) disappear as the objects/customs they describe go out of use` },
  ],
  // â”€â”€ Category 2: Borrowed Words â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  [
    { pts:100, q:`The word <em>boomerang</em> came into English from the Dharuk language of Australia. What does it describe, and why did English need to borrow the word?`, a:`A curved throwing weapon that returns to the thrower â€” English speakers had never seen one before, so they borrowed the Aboriginal word for it` },
    { pts:200, q:`<em>Shampoo</em> comes from the Hindi word <em>champo</em>, meaning "to press/massage." <em>Pyjamas</em> also comes from Hindi. What does this tell us about the relationship between Britain and India in the 18thâ€“19th centuries?`, a:`Britain had strong colonial ties with India â€” British people encountered Indian customs and objects and borrowed the words along with the things themselves` },
    { pts:300, q:`The word <em>ketchup</em> has a surprising origin â€” it comes from the Malay/Hokkien word <em>kicap</em>, meaning a fish or soy sauce. It travelled to Britain, then America, and came back to Malaysia as "tomato ketchup." What does this journey tell us about how words travel?`, a:`Words travel with trade and people â€” they can change meaning and ingredients along the way and even return to their origin culture in a completely new form` },
    { pts:400, q:`Match these borrowed words to their origin languages:<br><em>sofa</em> (Arabic / Turkish), <em>typhoon</em> (Cantonese / Greek), <em>bungalow</em> (Bengali / Hindi), <em>avatar</em> (Sanskrit / Hindi)`, a:`Sofa = Arabic; Typhoon = Cantonese (taifung) + Greek (typhon); Bungalow = Bengali (bangla); Avatar = Sanskrit (avatÄra, meaning descent of a god) â€” accept reasonable answers` },
    { pts:500, q:`English has borrowed words from dozens of languages. But borrowing isn't equal â€” powerful nations tend to export more words. Can you think of a modern example of a language borrowing words from English today, and why this might be happening?`, a:`Accept thoughtful answers â€” e.g. Malay borrows: komputer, telefon, televisyen, internet; French resists with loi Toubon; reflects global dominance of English through technology, media, and trade` },
  ],

  // â”€â”€ Category 3: Eponyms & Shakespeare & Shakespeare â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  [
    { pts:100, q:`Which inventor gave his name to a type of engine that runs on diesel fuel?`, a:`Rudolf Diesel` },
    { pts:200, q:`Using Shakespeare's word-building rules, what would <em>homeworkful</em> mean?`, a:`Full of homework (noun + ful = adjective describing something full of that noun) â€” accept any sensible definition` },
    { pts:300, q:`Shakespeare invented the word <em>uncomfortable</em>. Which rule did he use, and what does the prefix mean?`, a:`un + adjective = the opposite; "un" means not â€” so uncomfortable means not comfortable` },
    { pts:400, q:`The Earl of Sandwich gave his name to a food. What is the story â€” why is it called a sandwich?`, a:`The Earl of Sandwich reportedly asked for meat between bread so he could eat without leaving his card game â€” the snack was named after him` },
    { pts:500, q:`Invent a new word using Shakespeare's rules (noun+ful, noun+some, noun+y, noun+let, or un+adjective). Say the word, explain the rule you used, and use it in a sentence.`, a:`Creative answer â€” award points for correct use of a Shakespeare rule, a plausible meaning, and a correct sentence` },
  ],
  // â”€â”€ Category 4: Malay Loanwords ğŸ‡²ğŸ‡¾ Loanwords ğŸ‡²ğŸ‡¾ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
  [
    { pts:100, q:`The English word <em>orangutan</em> comes directly from Malay. What does it literally mean in Malay?`, a:`Orang = person, utan = forest/jungle â€” so "person of the forest"` },
    { pts:200, q:`The English word <em>amok</em> â€” as in "running amok" â€” comes from the Malay word <em>mengamuk</em>. What does it mean, and in what kind of sentence would you use it in English today?`, a:`To go into a wild, uncontrolled frenzy â€” e.g. "The children ran amok in the playground"` },
    { pts:300, q:`Three common English words â€” <em>bamboo</em>, <em>rattan</em>, and <em>gecko</em> â€” all came from Malay. What does this suggest about what British traders and travellers found in Southeast Asia that they had no words for?`, a:`They encountered plants, materials, and animals completely new to them â€” bamboo (buluh), rattan (rotan), gecko (cicak/gekok) â€” and borrowed the local names` },
    { pts:400, q:`The English word <em>compound</em> (as in a fenced area with buildings) comes from the Malay word <em>kampung</em>. How has the meaning changed, and can you think of a sentence using both the Malay and English meanings?`, a:`Kampung = village/community; compound in English = enclosed area of buildings â€” meaning has narrowed and shifted. Accept any sentence using both correctly` },
    { pts:500, q:`You now know that English borrowed <em>orangutan, amok, bamboo, rattan, gecko, compound, ketchup</em> from Malay. Does this change how you think about the English language? Is English really a "British" language? Discuss.`, a:`Open discussion â€” award points for reasoning: English is a global hybrid language, shaped by every culture it has touched; Malay contributions show Southeast Asia's influence on world English; no language truly "belongs" to one nation` },
  ],
];

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  TEAM CONFIG
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
const TEAM_COLORS = ['#00c9a7','#f7b731','#ef4444','#a29bfe','#38bdf8','#fb923c'];
const DEFAULT_NAMES = ['Team 1','Team 2','Team 3','Team 4','Team 5','Team 6'];
let teamConfig = DEFAULT_NAMES.map((n,i) => ({ name:n, color:TEAM_COLORS[i], active: i < 3 }));

function buildTeamSetup() {
  const el = document.getElementById('teamSetup'); el.innerHTML = '';
  teamConfig.forEach((t,i) => {
    const row = document.createElement('div'); row.className = 'team-row';
    row.innerHTML = `
      <div class="team-dot" style="background:${t.color}"></div>
      <input type="text" value="${t.name}" onchange="teamConfig[${i}].name=this.value" placeholder="Team ${i+1}">
      <div class="team-toggle ${t.active?'on':''}" onclick="toggleTeam(${i})" title="Toggle team">${t.active?'âœ“':'+'}</div>`;
    el.appendChild(row);
  });
}

function toggleTeam(i) {
  const active = teamConfig.filter(t=>t.active);
  if (teamConfig[i].active && active.length <= 2) return; // min 2 teams
  teamConfig[i].active = !teamConfig[i].active;
  buildTeamSetup();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  GAME STATE
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let teams = [];
let used = Array.from({length:5}, ()=> Array(5).fill(false));
let currentTeamIdx = 0;
let stealTeamIdx = -1;
let currentCell = null; // {cat, row}
let answerRevealed = false;
let stealing = false;

function startGame() {
  teams = teamConfig.filter(t=>t.active).map(t=>({ name:t.name, color:t.color, score:0 }));
  if (teams.length < 2) { alert('Please enable at least 2 teams.'); return; }
  used = Array.from({length:CATEGORIES.length}, ()=> Array(5).fill(false));
  currentTeamIdx = 0; stealing = false; stealTeamIdx = -1;
  document.getElementById('setupScreen').style.display = 'none';
  document.getElementById('boardScreen').style.display = 'block';
  renderBoard(); renderScoreBar(); updateTurnBar();
}

function showSetup() {
  document.getElementById('winOverlay').style.display = 'none';
  document.getElementById('boardScreen').style.display = 'none';
  document.getElementById('setupScreen').style.display = 'flex';
  buildTeamSetup();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  BOARD
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderBoard() {
  // Category headers
  const headers = document.getElementById('catHeaders'); headers.innerHTML = '';
  CATEGORIES.forEach((cat,i) => {
    const h = document.createElement('div');
    h.className = `cat-header ${cat.color}`;
    h.textContent = cat.name;
    headers.appendChild(h);
  });

  // Grid â€” 5 rows Ã— N cols
  const grid = document.getElementById('boardGrid'); grid.innerHTML = '';
  for (let row = 0; row < 5; row++) {
    for (let cat = 0; cat < CATEGORIES.length; cat++) {
      const cell = document.createElement('div');
      const pts = QUESTIONS[cat][row].pts;
      cell.className = `q-cell ${CATEGORIES[cat].color}${used[cat][row]?' used':''}`;
      cell.textContent = used[cat][row] ? '' : `Â£${pts}`;
      cell.dataset.cat = cat; cell.dataset.row = row;
      if (!used[cat][row]) cell.onclick = () => openQuestion(cat, row);
      grid.appendChild(cell);
    }
  }
}

function updateCell(cat, row) {
  const cells = document.querySelectorAll('.q-cell');
  cells.forEach(c => {
    if (+c.dataset.cat === cat && +c.dataset.row === row) {
      c.classList.add('used'); c.textContent = ''; c.onclick = null;
    }
  });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  SCORE BAR
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function renderScoreBar() {
  const bar = document.getElementById('scoreBar'); bar.innerHTML = '';
  teams.forEach((t,i) => {
    const chip = document.createElement('div');
    chip.className = 'score-chip' +
      (i===currentTeamIdx && !stealing ? ' active-team' : '') +
      (stealing && i===stealTeamIdx ? ' stealing' : '');
    chip.id = `chip-${i}`;
    chip.innerHTML = `<div class="chip-dot" style="background:${t.color}"></div>
      <span class="chip-name">${t.name}</span>
      <span class="chip-score">Â£${t.score}</span>`;
    bar.appendChild(chip);
  });
}

function updateTurnBar(msg) {
  const t = teams[currentTeamIdx];
  document.getElementById('turnBar').textContent =
    msg || `${t.name}'s turn â€” pick a question`;
  document.getElementById('turnBar').style.color = t.color;
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  QUESTION MODAL
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function openQuestion(cat, row) {
  // Only current team can pick from board
  currentCell = {cat, row};
  stealing = false; stealTeamIdx = -1; answerRevealed = false;
  const q = QUESTIONS[cat][row];

  document.getElementById('mCat').textContent = CATEGORIES[cat].name;
  document.getElementById('mCat').style.color = ['#60a5fa','#4ade80','#c084fc','#fb923c','#2dd4bf'][cat];
  document.getElementById('mPts').textContent = `Â£${q.pts}`;
  document.getElementById('mQ').innerHTML = q.q;
  document.getElementById('mAns').textContent = `âœ“ Answer: ${q.a}`;
  document.getElementById('mAns').classList.remove('visible');
  document.getElementById('stealBanner').classList.remove('visible');
  document.getElementById('stealPicker').classList.remove('visible');

  buildModalBtns('initial');
  document.getElementById('qModal').style.display = 'flex';
}

function buildModalBtns(state) {
  const btns = document.getElementById('mBtns');
  btns.innerHTML = '';

  if (state === 'initial') {
    // Reveal + Correct + Wrong + Close
    add('Reveal Answer', 'mbtn mbtn-reveal', revealAnswer);
    add('âœ“ Correct', 'mbtn mbtn-correct', () => judgeAnswer(true));
    add('âœ— Wrong', 'mbtn mbtn-wrong', () => judgeAnswer(false));
    add('âœ• Skip', 'mbtn mbtn-close', closeModal);
  } else if (state === 'steal') {
    // After wrong â€” show steal picker, correct/wrong for steal team
    add('âœ“ Correct (steal)', 'mbtn mbtn-correct', () => judgeSteal(true));
    add('âœ— Wrong (steal)', 'mbtn mbtn-wrong', () => judgeSteal(false));
    add('âœ• No steal', 'mbtn mbtn-close', () => { closeModal(); advanceTurn(); });
  } else if (state === 'revealed-initial') {
    add('âœ“ Correct', 'mbtn mbtn-correct', () => judgeAnswer(true));
    add('âœ— Wrong', 'mbtn mbtn-wrong', () => judgeAnswer(false));
    add('âœ• Skip', 'mbtn mbtn-close', closeModal);
  } else if (state === 'revealed-steal') {
    add('âœ“ Correct (steal)', 'mbtn mbtn-correct', () => judgeSteal(true));
    add('âœ— Wrong (steal)', 'mbtn mbtn-wrong', () => judgeSteal(false));
    add('âœ• No steal', 'mbtn mbtn-close', () => { closeModal(); advanceTurn(); });
  }

  function add(label, cls, fn) {
    const b = document.createElement('button');
    b.className = `mbtn ${cls}`; b.textContent = label; b.onclick = fn;
    btns.appendChild(b);
  }
}

function revealAnswer() {
  answerRevealed = true;
  document.getElementById('mAns').classList.add('visible');
  buildModalBtns(stealing ? 'revealed-steal' : 'revealed-initial');
}

function judgeAnswer(correct) {
  const q = QUESTIONS[currentCell.cat][currentCell.row];
  if (correct) {
    teams[currentTeamIdx].score += q.pts;
    playCorrect();
    markUsed();
    closeModal();
    advanceTurn();
  } else {
    // Wrong â€” offer steal
    playWrong();
    stealing = true;
    showStealPicker();
  }
}

function showStealPicker() {
  const banner = document.getElementById('stealBanner');
  banner.textContent = `${teams[currentTeamIdx].name} got it wrong! Another team can steal...`;
  banner.classList.add('visible');

  const picker = document.getElementById('stealPicker');
  picker.classList.add('visible');
  const stealTeamsEl = document.getElementById('stealTeams');
  stealTeamsEl.innerHTML = '';
  teams.forEach((t,i) => {
    if (i === currentTeamIdx) return;
    const btn = document.createElement('button');
    btn.className = 'steal-team-btn' + (i===stealTeamIdx?' selected':'');
    btn.innerHTML = `<span style="width:8px;height:8px;border-radius:50%;background:${t.color};display:inline-block;"></span> ${t.name}`;
    btn.onclick = () => { stealTeamIdx = i; renderScoreBar(); showStealPicker(); buildModalBtns(answerRevealed?'revealed-steal':'steal'); };
    stealTeamsEl.appendChild(btn);
  });
  buildModalBtns(answerRevealed ? 'revealed-steal' : 'steal');
  renderScoreBar();
}

function judgeSteal(correct) {
  if (stealTeamIdx === -1) { alert('Please select a team to steal first.'); return; }
  const q = QUESTIONS[currentCell.cat][currentCell.row];
  if (correct) {
    teams[stealTeamIdx].score += q.pts;
    playCorrect();
  } else {
    playWrong();
  }
  markUsed();
  closeModal();
  // Turn passes to stealing team if correct, otherwise advances normally
  if (correct) currentTeamIdx = stealTeamIdx;
  advanceTurn();
}

function markUsed() {
  const {cat, row} = currentCell;
  used[cat][row] = true;
  updateCell(cat, row);
}

function closeModal() {
  document.getElementById('qModal').style.display = 'none';
  stealing = false; stealTeamIdx = -1;
  renderScoreBar();
}

function advanceTurn() {
  // Check if all questions used
  const allDone = used.every(col => col.every(v => v));
  if (allDone) { setTimeout(showWin, 400); return; }
  currentTeamIdx = (currentTeamIdx + 1) % teams.length;
  renderScoreBar();
  updateTurnBar();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  WIN
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
function showWin() {
  const sorted = [...teams].sort((a,b) => b.score - a.score);
  const winner = sorted[0];
  document.getElementById('winName').textContent = `ğŸ‰ ${winner.name} wins with Â£${winner.score}!`;
  document.getElementById('winName').style.color = winner.color;

  const fs = document.getElementById('finalScores'); fs.innerHTML = '';
  sorted.forEach((t,i) => {
    const row = document.createElement('div');
    row.className = 'final-row' + (i===0?' winner':'');
    row.innerHTML = `<span style="width:10px;height:10px;border-radius:50%;background:${t.color};display:inline-block;"></span>
      <span style="flex:1;font-weight:700">${t.name}</span>
      <span style="font-size:1.2rem;font-weight:900;color:var(--gold)">Â£${t.score}</span>`;
    fs.appendChild(row);
  });
  document.getElementById('winOverlay').style.display = 'flex';
  playWin();
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  AUDIO
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
let actx = null;
function ac() { if(!actx) actx=new(window.AudioContext||window.webkitAudioContext)(); return actx; }
function playCorrect() {
  const ctx=ac(); [523,659,784].forEach((f,i)=>{ const t=ctx.currentTime+i*0.1; const o=ctx.createOscillator(); o.type='triangle'; o.frequency.value=f; const g=ctx.createGain(); g.gain.setValueAtTime(0.3,t); g.gain.exponentialRampToValueAtTime(0.001,t+0.25); o.connect(g); g.connect(ctx.destination); o.start(t); o.stop(t+0.25); });
}
function playWrong() {
  const ctx=ac(),t=ctx.currentTime; [300,220].forEach((f,i)=>{ const st=t+i*0.15; const o=ctx.createOscillator(); o.type='sawtooth'; o.frequency.value=f; const g=ctx.createGain(); g.gain.setValueAtTime(0.25,st); g.gain.exponentialRampToValueAtTime(0.001,st+0.2); o.connect(g); g.connect(ctx.destination); o.start(st); o.stop(st+0.2); });
}
function playWin() {
  const ctx=ac(); [523,659,784,1047,1319].forEach((f,i)=>{ const t=ctx.currentTime+i*0.13; const o=ctx.createOscillator(); o.type='triangle'; o.frequency.value=f; const g=ctx.createGain(); g.gain.setValueAtTime(0.35,t); g.gain.exponentialRampToValueAtTime(0.001,t+0.4); o.connect(g); g.connect(ctx.destination); o.start(t); o.stop(t+0.4); });
}

// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
//  INIT
// â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
buildTeamSetup();
</script>
</body>
</html>
