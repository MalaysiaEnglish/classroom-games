<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Hangman Modes</title>
  <link rel="stylesheet" href="../style.css">
  <script src="../content.js" onerror="console.log('No content.js')"></script>
</head>

<body class="hangman-page">
  <h1>Hangman Modes</h1>

  <div class="controls">
    <button id="newGame">âš™ï¸ New Game</button>
    <button id="fullscreen">â›¶ Fullscreen</button>
    <button id="home">ğŸ  Home</button>
  </div>

  <div class="game-wrapper">

    <!-- â”€â”€ SETUP SCREEN â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="hm-setup" id="setupScreen">
      <h2>Set up your game</h2>

      <div class="hm-setup-section">
        <label>How many teams?</label>
        <div class="hm-picker" id="teamPicker">
          <button data-n="2">2</button>
          <button data-n="3">3</button>
          <button data-n="4" class="hm-selected">4</button>
          <button data-n="5">5</button>
        </div>
      </div>

      <div class="hm-setup-section">
        <label>Mode</label>
        <div class="hm-picker" id="modePicker">
          <button data-mode="basic"      class="hm-selected">ğŸ”¤ Basic</button>
          <button data-mode="consonant">ğŸ”¡ Consonant</button>
          <button data-mode="diceman">ğŸ² Diceman</button>
        </div>
      </div>

      <div class="hm-setup-section">

      </div>

      <div class="hm-setup-section">
        <label>Category</label>
        <div class="hm-picker" id="wordlistPicker">
          <!-- Populated dynamically -->
        </div>
      </div>

      <button class="hm-start-btn" id="startBtn">â–¶ Start Game</button>
    </div>

    <!-- â”€â”€ GAME AREA â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ -->
    <div class="hm-game" id="gameArea">

      <div id="currentTurn">Get ready!</div>

      <!-- Top section: canvas + word board side by side -->
      <div class="hm-top">
        <canvas id="hangmanCanvas" width="220" height="260"></canvas>
        <div class="hm-word-col">
          <div class="hm-word-board" id="gameBoard"></div>
          <!-- Diceman panel lives HERE, beside the word, not floating -->
          <div class="hm-diceman" id="dicePanel">
            <div class="hm-dice-face" id="diceFace">ğŸ²</div>
            <table class="hm-dice-table">
              <tr><td>âš€ 1</td><td>Ã— 10 pts</td></tr>
              <tr><td>âš 2</td><td>Ã— 20 pts</td></tr>
              <tr><td>âš‚ 3</td><td>Ã— 30 pts</td></tr>
              <tr><td>âšƒ 4</td><td class="hm-bankrupt">ğŸ’¸ Bankrupt</td></tr>
              <tr><td>âš„ 5</td><td>Ã— 50 pts</td></tr>
              <tr><td>âš… 6</td><td>Ã— 100 pts</td></tr>
            </table>
          </div>
        </div>
      </div>

      <!-- Letter grid -->
      <div class="hm-letters" id="letters"></div>

      <!-- Scoreboard -->
      <div class="scoreboard" id="scoreboard"></div>

    </div><!-- end gameArea -->

  </div><!-- end game-wrapper -->

  <script>
    const canvas = document.getElementById('hangmanCanvas');
    const ctx    = canvas.getContext('2d');
    const MAX_WRONG = 10;

    let currentWord = '', revealed = [], guessedLetters = new Set();
    let wrongGuesses = 0, totalScores = [], currentWordPoints = [];
    let currentTeam = 0, totalTeams = 0, mode = '', lastRolls = [];

    const wordLists = {};   // filled from wordlists.json
    let words = [];
    let selTeams = 4, selMode = 'basic', selList = '';

    // â”€â”€ Build category picker â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function buildCategoryPicker() {
      const picker = document.getElementById('wordlistPicker');
      picker.innerHTML = '';

      // Collect topics â€” merge words from all matching entries per topic label
      const topicMap = {};   // label â†’ { keys[], words[] }
      for (const [key, cat] of Object.entries(wordLists)) {
        if (key.startsWith('_')) continue;

        const lbl = cat.label;
        if (!topicMap[lbl]) topicMap[lbl] = { keys: [], words: [] };
        topicMap[lbl].keys.push(key);
        topicMap[lbl].words.push(...cat.words);
      }

      // "Random â€” all" always first
      const randBtn = document.createElement('button');
      randBtn.textContent  = 'ğŸ² Random â€” all';
      randBtn.dataset.list = '__random__';
      if (selList === '__random__') randBtn.classList.add('hm-selected');
      randBtn.onclick = () => {
        selList = '__random__';
        words   = buildRandomPool();
        pickBtn('wordlistPicker', 'list', '__random__');
      };
      picker.appendChild(randBtn);

      // One button per topic
      let firstCat = true;
      for (const [lbl, data] of Object.entries(topicMap)) {
        const topicKey = data.keys.join('+');
        const btn = document.createElement('button');
        btn.textContent   = lbl;
        btn.dataset.list  = topicKey;
        if (selList === topicKey) btn.classList.add('hm-selected');
        btn.onclick = () => {
          selList = topicKey;
          words   = [...data.words];
          pickBtn('wordlistPicker', 'list', topicKey);
        };
        picker.appendChild(btn);

        if (firstCat && selList !== '__random__') {
          selList = topicKey;
          words   = [...data.words];
          btn.classList.add('hm-selected');
          firstCat = false;
        }
      }

      // Fall back to random if nothing selected
      if (!picker.querySelector('.hm-selected')) {
        selList = '__random__';
        words   = buildRandomPool();
        randBtn.classList.add('hm-selected');
      }
    }

    function buildRandomPool() {
      const pool = [];
      for (const [key, cat] of Object.entries(wordLists)) {
        if (key.startsWith('_')) continue;
        pool.push(...cat.words);
      }
      return pool.length ? pool : ['ELEPHANT','TIGER','PENGUIN','DOLPHIN','GIRAFFE'];
    }

    // â”€â”€ Full word list embedded (works without a server) â”€â”€
    const BUILT_IN = {
      "animals":    { label:"ğŸ˜ Animals",         words:["CAT","DOG","COW","PIG","HEN","FOX","OWL","BAT","BEE","ANT","FISH","FROG","BEAR","DUCK","DEER","LION","WOLF","CRAB","WORM","BIRD","TIGER","HORSE","SHARK","WHALE","EAGLE","SNAKE","MOUSE","RABBIT","PARROT","MONKEY","DOLPHIN","PENGUIN","GIRAFFE","CHEETAH","LEOPARD","GORILLA","FLAMINGO","CROCODILE","TORTOISE","HEDGEHOG","PORCUPINE","CHAMELEON","PELICAN","OCTOPUS","LOBSTER","SEAHORSE","JELLYFISH","STINGRAY","PIRANHA","TOUCAN","PEACOCK","OSTRICH","MEERKAT","PLATYPUS","CHIPMUNK","SQUIRREL","ORANGUTAN","CHIMPANZEE","HIPPOPOTAMUS","RHINOCEROS","ARMADILLO","AXOLOTL","KOMODO DRAGON","NARWHAL","CAPYBARA","PANGOLIN","OKAPI","CASSOWARY","MANATEE","DUGONG","BELUGA WHALE"] },
      "food":       { label:"ğŸ• Food",             words:["CAKE","RICE","BREAD","MILK","EGGS","SOUP","FISH","MEAT","CORN","APPLE","MANGO","GRAPE","MELON","PIZZA","PASTA","CHIPS","JUICE","TOAST","SALAD","NOODLES","BURGER","COOKIE","HONEY","BUTTER","CHEESE","YOGURT","CEREAL","WAFFLE","SUSHI","TACOS","LAKSA","SATAY","RENDANG","BIRYANI","CURRY","DUMPLING","ROTI CANAI","NASI LEMAK","SPRING ROLLS","CROISSANT","BROWNIE","CHEESECAKE","TIRAMISU","SMOOTHIE","MILKSHAKE","CAPPUCCINO","GUACAMOLE","HUMMUS","BRUSCHETTA","ENCHILADA","BURRITO","PAELLA","RISOTTO","GNOCCHI","FALAFEL","SHAWARMA","SAMOSA","PAKORA","BOUILLABAISSE","RATATOUILLE","COQ AU VIN","CEVICHE","CHIMICHURRI","EMPANADA","CHAR KUEY TEOW","CHILLI PAN MEE","HOKKIEN MEE","BAKKUT TEH","POUTINE","GOULASH","STROGANOFF","SCHNITZEL","MOUSSAKA","SHAKSHUKA","TAGINE","PHO","BIBIMBAP","OKONOMIYAKI"] },
      "sports":     { label:"âš½ Sports",           words:["RUN","SWIM","JUMP","KICK","THROW","CATCH","HIT","RACE","FOOTBALL","TENNIS","CRICKET","HOCKEY","RUGBY","BOXING","CYCLING","SKATING","CLIMBING","DANCING","BOWLING","GOLF","BADMINTON","BASKETBALL","VOLLEYBALL","GYMNASTICS","ATHLETICS","TAEKWONDO","JUDO","WRESTLING","FENCING","ARCHERY","SQUASH","SNOOKER","SKATEBOARDING","SURFING","KAYAKING","ROWING","SAILING","MARATHON","TRIATHLON","DECATHLON","GOALKEEPER","MIDFIELDER","DEFENDER","STRIKER","REFEREE","WEIGHTLIFTING","EQUESTRIAN","PARAGLIDING","POLE VAULT","HAMMER THROW","SHOT PUT","JAVELIN","DISCUS","CHAMPIONSHIP","TOURNAMENT","QUALIFIER","SEMIFINAL","KNOCKOUT","SPONSORSHIP","COMMENTATOR","PENALTY SHOOTOUT","GOLDEN GOAL","SUDDEN DEATH"] },
      "adjectives": { label:"ğŸ’¬ Adjectives",       words:["BIG","TINY","HOT","COLD","WET","DRY","SOFT","HARD","FAST","SLOW","LOUD","QUIET","LIGHT","DARK","CLEAN","DIRTY","HAPPY","SAD","KIND","MEAN","BRAVE","FUNNY","SILLY","SMART","CUTE","UGLY","SWEET","SOUR","SHARP","ROUND","ENORMOUS","MINIATURE","ANCIENT","MODERN","FURIOUS","PEACEFUL","GENEROUS","GREEDY","COWARDLY","FEARLESS","TALENTED","CLUMSY","MYSTERIOUS","OBVIOUS","FILTHY","SPOTLESS","CHEERFUL","MISERABLE","GORGEOUS","HIDEOUS","FRAGILE","STURDY","SHALLOW","RECKLESS","CAUTIOUS","ARROGANT","HUMBLE","SINCERE","DECEITFUL","MELANCHOLIC","EUPHORIC","AMBIVALENT","SYCOPHANTIC","OSTENTATIOUS","MAGNANIMOUS","BELLICOSE","OBSTINATE","LOQUACIOUS","TACITURN","PERSPICACIOUS","OBSEQUIOUS","TENACIOUS","CAPRICIOUS","FASTIDIOUS","SAGACIOUS","MENDACIOUS","NEFARIOUS","VOCIFEROUS","GREGARIOUS","LACONIC","PEDANTIC","SARDONIC","ENIGMATIC"] },
      "igcse_english":{ label:"ğŸ“ IGCSE English", words:["METAPHOR","SIMILE","ALLITERATION","ONOMATOPOEIA","PERSONIFICATION","HYPERBOLE","IRONY","SARCASM","OXYMORON","PARADOX","FORESHADOWING","FLASHBACK","NARRATIVE","PROTAGONIST","ANTAGONIST","CHARACTERISATION","SOLILOQUY","MONOLOGUE","DIALOGUE","SYNOPSIS","ATMOSPHERE","IMAGERY","SYMBOLISM","INFERENCE","CONNOTATION","DENOTATION","AMBIGUITY","RHETORIC","PERSUASION","ANAPHORA","JUXTAPOSITION"] },
      "countries":  { label:"ğŸŒ Countries",        words:["MALAYSIA","SINGAPORE","INDONESIA","THAILAND","VIETNAM","PHILIPPINES","CAMBODIA","MYANMAR","BRUNEI","LAOS","CHINA","JAPAN","SOUTH KOREA","MONGOLIA","TAIWAN","INDIA","PAKISTAN","SRI LANKA","NEPAL","BANGLADESH","AUSTRALIA","NEW ZEALAND","EGYPT","MOROCCO","KENYA","BRAZIL","ARGENTINA","COLOMBIA","MEXICO","CANADA","UNITED KINGDOM","FRANCE","GERMANY","ITALY","SPAIN","PORTUGAL","NETHERLANDS","SWEDEN","NORWAY","TURKEY"] },
      "malaysia":   { label:"ğŸ‡²ğŸ‡¾ Malaysia",        words:["KUALA LUMPUR","PENANG","MALACCA","JOHOR BAHRU","KOTA KINABALU","KUCHING","PUTRAJAYA","PETRONAS","BATU CAVES","LANGKAWI","CAMERON HIGHLANDS","GENTING HIGHLANDS","SUNWAY LAGOON","KLCC","NASI LEMAK","ROTI CANAI","CHAR KUEY TEOW","LAKSA","SATAY","TEH TARIK","CENDOL","DURIAN","MANGOSTEEN","RAMBUTAN","MERDEKA","RINGGIT","HORNBILL","PROBOSCIS MONKEY","ORANGUTAN","TAPIR","SUNBEAR"] },
      "science":    { label:"ğŸ”¬ Science",          words:["PHOTOSYNTHESIS","MITOCHONDRIA","CHROMOSOME","ECOSYSTEM","EVOLUTION","RESPIRATION","DIGESTION","CIRCULATION","GERMINATION","COMBUSTION","GRAVITY","MAGNETISM","ELECTRICITY","RADIATION","REFRACTION","CONDENSATION","EVAPORATION","PRECIPITATION","SUBLIMATION","HYDROGEN","NITROGEN","OXYGEN","CARBON DIOXIDE","AMMONIA","ELEMENT","COMPOUND","MOLECULE","ATOM","NEUTRON","PROTON","ELECTROMAGNETISM","THERMODYNAMICS","BIOLUMINESCENCE","CHEMOSYNTHESIS","TECTONIC PLATES","SEISMOGRAPH","SPECTROSCOPY","ELECTROLYSIS","CATALYSIS","STOICHIOMETRY","QUANTUM MECHANICS","SUPERCONDUCTOR","SEMICONDUCTOR","TRANSISTOR","PHOTOELECTRIC","RADIOACTIVE DECAY","NUCLEAR FISSION","CENTRIPETAL FORCE"] },
      "technology": { label:"ğŸ’» Technology",       words:["ALGORITHM","ARTIFICIAL INTELLIGENCE","BLOCKCHAIN","ENCRYPTION","CYBERSECURITY","PROGRAMMING","DEBUGGING","FRAMEWORK","REPOSITORY","CLOUD STORAGE","VIRTUAL REALITY","AUGMENTED REALITY","MACHINE LEARNING","NEURAL NETWORK","DEEP LEARNING","SEMICONDUCTOR","MICROPROCESSOR","QUANTUM COMPUTING","BANDWIDTH","LATENCY","FIREWALL","MALWARE","PHISHING","OPEN SOURCE","CONTAINERISATION","VERSION CONTROL","AGILE METHODOLOGY"] },
      "jobs":       { label:"ğŸ’¼ Jobs",             words:["ARCHITECT","ACCOUNTANT","ASTRONAUT","ARCHAEOLOGIST","SURGEON","PHYSIOTHERAPIST","PHARMACIST","PARAMEDIC","ENGINEER","PROGRAMMER","TECHNICIAN","ELECTRICIAN","PLUMBER","JOURNALIST","PHOTOGRAPHER","FILMMAKER","BROADCASTER","BARRISTER","SOLICITOR","MAGISTRATE","DETECTIVE","AMBASSADOR","DIPLOMAT","POLITICIAN","CHOREOGRAPHER","CONDUCTOR","COMPOSER","ILLUSTRATOR","SCULPTOR","ENTREPRENEUR","CONSULTANT","ANALYST","VETERINARIAN","BOTANIST"] },
    };;
    // â”€â”€ Load word lists: custom content.js if available, built-ins as fallback â”€â”€
    const hasCustomWords = window.CUSTOM_CONTENT &&
                           window.CUSTOM_CONTENT.words &&
                           window.CUSTOM_CONTENT.words.length > 0;

    // Always load built-in word lists as a base
    Object.assign(wordLists, BUILT_IN);

    if (hasCustomWords) {
      // Group custom words by topic â†’ one category per topic, added on top of built-ins
      const groups = {};
      window.CUSTOM_CONTENT.words.forEach(w => {
        const key  = w.topic || 'Custom';
        if (!groups[key]) groups[key] = { label: key, words: [] };
        groups[key].words.push(w.word);
      });
      Object.entries(groups).forEach(([key, cat]) => {
        const safeKey = 'custom_' + key.toLowerCase().replace(/[^a-z0-9]/g, '_');
        wordLists[safeKey] = cat;
      });
    }

    // Try to load wordlists.json to add any extra lists (non-destructive merge)
    fetch('../wordlists.json')
      .then(r => r.json())
      .then(data => {
        Object.assign(wordLists, data);
        selList = '';
        buildCategoryPicker();
      })
      .catch(() => {
        // JSON not available â€” use what we have
        selList = '';
        buildCategoryPicker();
      });

    function pickBtn(groupId, key, val) {
      document.querySelectorAll(`#${groupId} button`).forEach(b =>
        b.classList.toggle('hm-selected', b.dataset[key] === val)
      );
    }

    document.querySelectorAll('#teamPicker button').forEach(b =>
      b.onclick = () => { selTeams = +b.dataset.n; pickBtn('teamPicker','n',b.dataset.n); }
    );
    document.querySelectorAll('#modePicker button').forEach(b =>
      b.onclick = () => { selMode = b.dataset.mode; pickBtn('modePicker','mode',b.dataset.mode); }
    );

    document.getElementById('startBtn').onclick = () => {
      document.getElementById('setupScreen').style.display = 'none';
      document.getElementById('gameArea').style.display    = 'flex';
      initGame(selTeams, selMode);
    };

    document.getElementById('newGame').onclick = () => {
      document.getElementById('setupScreen').style.display = 'flex';
      document.getElementById('gameArea').style.display    = 'none';
    };

    // â”€â”€ Hangman drawing â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function drawHangman(s) {
      ctx.clearRect(0,0,canvas.width,canvas.height);
      ctx.lineWidth = 5; ctx.strokeStyle = '#222'; ctx.lineCap = 'round';
      const d = (x,y,x2,y2) => { ctx.beginPath(); ctx.moveTo(x,y); ctx.lineTo(x2,y2); ctx.stroke(); };
      if (s>=1)  d(10,240,210,240);
      if (s>=2)  d(50,240,50,30);
      if (s>=3)  d(50,30,150,30);
      if (s>=4)  d(150,30,150,65);
      if (s>=5)  { ctx.beginPath(); ctx.arc(150,88,23,0,Math.PI*2); ctx.stroke(); }
      if (s>=6)  d(150,111,150,175);
      if (s>=7)  d(150,130,115,160);
      if (s>=8)  d(150,130,185,160);
      if (s>=9)  d(150,175,120,220);
      if (s>=10) d(150,175,180,220);
    }

    // â”€â”€ Vowel locks â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function updateVowelLocks() {
      if (mode !== 'consonant') return;
      document.querySelectorAll('#letters button').forEach(btn => {
        if (!'AEIOU'.includes(btn.textContent) || guessedLetters.has(btn.textContent)) return;
        const locked = totalScores[currentTeam] < 1;
        btn.disabled = locked;
        btn.classList.toggle('hm-vowel-locked', locked);
      });
    }

    // â”€â”€ Scoreboard â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderScoreboard() {
      const sb = document.getElementById('scoreboard');
      sb.innerHTML = '';
      totalScores.forEach((pts, i) => {
        const d = document.createElement('div');
        d.className = 'team-score' + (i === currentTeam ? ' active' : '');
        d.innerHTML = `<strong>Team ${i+1}</strong><br>${pts}`;
        if (currentWordPoints[i] > 0) d.innerHTML += `<br><small>+${currentWordPoints[i]} this word</small>`;
        if (lastRolls[i])             d.innerHTML += `<br><small>${lastRolls[i]}</small>`;
        sb.appendChild(d);
      });
      updateVowelLocks();
    }

    // â”€â”€ Letter buttons â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function buildLetters() {
      const l = document.getElementById('letters');
      l.innerHTML = '';
      'ABCDEFGHIJKLMNOPQRSTUVWXYZ'.split('').forEach(ch => {
        const b = document.createElement('button');
        b.textContent = ch;
        b.onclick = () => guessLetter(ch, b);
        l.appendChild(b);
      });
      updateVowelLocks();
    }

    // â”€â”€ Render word board â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function renderBoard() {
      const board = document.getElementById('gameBoard');
      // Each char slot = 1 char + margins. Fit ALL chars on one line.
      // Available width â‰ˆ min(board.offsetWidth, 90vw) minus padding
      const available = (board.offsetWidth || window.innerWidth * 0.9) - 40;
      // Number of character slots (spaces count as half a slot)
      const slots = revealed.reduce((n, ch) => n + (ch === '/' ? 0.6 : 1.2), 0);
      // px per slot, capped between 14px and 48px
      const px = Math.min(48, Math.max(14, Math.floor(available / slots)));
      const size = px + 'px';
      board.style.flexWrap = 'nowrap';
      board.style.overflowX = 'auto';
      board.innerHTML = revealed.map(ch => {
        if (ch === '/') return `<span style="display:inline-block;width:${Math.round(px*0.6)}px;flex-shrink:0"> </span>`;
        const isLetter = ch !== '_';
        return `<span style="display:inline-block;width:${Math.round(px*1.05)}px;flex-shrink:0;text-align:center;font-size:${size};border-bottom:${Math.max(2,Math.round(px/14))}px solid #0f172a;margin:0 1px;line-height:1.4;font-weight:900;color:${isLetter?'#c0392b':'#0f172a'}">${isLetter?ch:'_'}</span>`;
      }).join('');
    }

    // â”€â”€ New word â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function nextWord() {
      currentWord       = words[Math.floor(Math.random()*words.length)].toUpperCase();
      revealed          = currentWord.split('').map(c => c===' ' ? '/' : '_');
      guessedLetters    = new Set();
      wrongGuesses      = 0;
      currentWordPoints = Array(totalTeams).fill(0);
      lastRolls         = Array(totalTeams).fill(null);
      renderBoard();
      drawHangman(0);
      renderScoreboard();
      buildLetters();
    }

    // â”€â”€ Init â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function initGame(teamCount, gameMode) {
      totalTeams        = teamCount;
      totalScores       = Array(teamCount).fill(0);
      currentWordPoints = Array(teamCount).fill(0);
      currentTeam       = 0;
      lastRolls         = Array(teamCount).fill(null);
      mode              = gameMode;
      document.getElementById('dicePanel').style.display = gameMode==='diceman' ? 'block' : 'none';
      document.getElementById('currentTurn').textContent = "Team 1's turn!";
      nextWord();
    }

    // â”€â”€ Guess â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function guessLetter(letter, btn) {
      if (guessedLetters.has(letter)) return;
      guessedLetters.add(letter);
      const isVowel = 'AEIOU'.includes(letter);

      if (mode==='consonant' && isVowel) {
        if (totalScores[currentTeam] < 1) {
          document.getElementById('currentTurn').textContent = `Team ${currentTeam+1} needs 1 point to buy a vowel!`;
          guessedLetters.delete(letter);
          return;
        }
        totalScores[currentTeam]--;
      }

      btn.disabled = true;
      let hits = 0;
      currentWord.split('').forEach((ch,i) => { if(ch===letter){ revealed[i]=letter; hits++; } });
      renderBoard();

      if (hits === 0) {
        wrongGuesses++;
        drawHangman(wrongGuesses);
        currentTeam = (currentTeam+1) % totalTeams;
        document.getElementById('currentTurn').textContent = `Wrong! Team ${currentTeam+1}'s turn`;
        if (wrongGuesses >= MAX_WRONG) {
          setTimeout(() => {
            document.getElementById('currentTurn').textContent = `Game over! The word was: ${currentWord}`;
            setTimeout(nextWord, 3000);
          }, 500);
        }
      } else {
        if (mode==='consonant' && !isVowel) {
          currentWordPoints[currentTeam] += hits;
          totalScores[currentTeam]       += hits;
        } else if (mode==='diceman') {
          rollDie(hits);
        } else {
          totalScores[currentTeam] += hits;
        }
      }

      renderScoreboard();

      if (!revealed.includes('_')) {
        setTimeout(() => {
          document.getElementById('currentTurn').textContent = `ğŸ‰ Team ${currentTeam+1} solved it! +10 bonus!`;
          totalScores[currentTeam] += 10;
          renderScoreboard();
          setTimeout(nextWord, 2500);
        }, 400);
      }
    }

    // â”€â”€ Dice â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
    function rollDie(hits) {
      const faces = ['âš€','âš','âš‚','âšƒ','âš„','âš…'];
      const roll  = Math.floor(Math.random()*6)+1;
      document.getElementById('diceFace').textContent = faces[roll-1];
      let pts=0, effect='';
      switch(roll){
        case 1: pts=hits*10;  effect=`Ã—10 (+${pts})`; break;
        case 2: pts=hits*20;  effect=`Ã—20 (+${pts})`; break;
        case 3: pts=hits*30;  effect=`Ã—30 (+${pts})`; break;
        case 4: pts=-totalScores[currentTeam]; effect='ğŸ’¸ Bankrupt'; break;
        case 5: pts=hits*50;  effect=`Ã—50 (+${pts})`; break;
        case 6: pts=hits*100; effect=`Ã—100 (+${pts})`; break;
      }
      totalScores[currentTeam] += pts;
      lastRolls[currentTeam]    = effect;
      renderScoreboard();
    }

    document.getElementById('fullscreen').onclick = () => document.documentElement.requestFullscreen?.();
    document.getElementById('home').onclick       = () => window.location.href = '../index.html';

    drawHangman(0);
    // Re-render on resize so word always fits
    window.addEventListener('resize', () => { if (currentWord) renderBoard(); });
  </script>
</body>
</html>
